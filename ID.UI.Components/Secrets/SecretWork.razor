@inherits SecretWorkComponent

@if(CurrentList.Count > 0)
{
    <MudStack Spacing="1">
        <MudText Align="Align.Center" Typo="Typo.h6" Color="Color.Primary">Добавленные ключи</MudText>

        <MudList Clickable="true" Dense="true" DisableGutters="true">
            @foreach (var key in CurrentList)
            {
                <MudListItem Icon="@Icons.Material.Filled.DeleteOutline"
                             IconColor="Color.Error"
                             OnClick="() => RemoveSecretInList(key)">
                    @key.Value@(key.Expiration.HasValue ? $"   до {@key.Expiration.Value:d}" : "")
                </MudListItem>
            }
        </MudList>
    </MudStack>
}

<MudStack Spacing="3">
    <MudText Align="Align.Center" Typo="Typo.h6" Color="Color.Primary">Добавить новый ключ</MudText>
    <MudForm @ref="ModelForm" Model="Model">
        <MudTextField @bind-Value="@Model.Value"
                      Label="Ключ (обязателен)"
                      HelperText="Запомните ключ для дальнейшего использования"
                      AutoFocus="true"
                      Immediate="true"
                      For="() => Model.Value"
                      Validation="Model.Validator.IsValid"
                      T="string"
                      InputMode="InputMode.text" />

        <MudTextField @bind-Value="@Model.Description"
                      Immediate="true"
                      Label="Описание ключа (не обязательно)" />

        <MudDatePicker Label="Валиден до (не обязательно)"
                       Editable="true"
                       @bind-Date="Model.Expiration"
                       Mask="@(new DateMask("dd.MM.yyyy"))"
                       DateFormat="dd.MM.yyyy"
                       For="() => Model.Expiration"
                       Validation="Model.Validator.IsValid"
                       Placeholder="dd.MM.yyyy" />
    </MudForm>

    <MudButton Color="Color.Primary"
               Variant="Variant.Filled"
               Disabled="!ModelForm.IsValid"
               Size="Size.Small"
               OnClick="AddSecretToList">Сохранить</MudButton>
</MudStack>